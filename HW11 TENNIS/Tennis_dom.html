<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TENNIS</title>
<style>
  #court {
    background-color: yellow;
    position: relative;
  }
  #firstPlayer {
    background-color: green;
    position: absolute;
  }
  #secondPlayer {
    background-color: fuchsia;
    position: absolute;
  }
  #ball {
    background-color: red;
    width: 30px;
    height: 30px;
    border-radius: 50%;
    position: absolute;
  }

</style>
</head>
<body>
  <button onclick="tick()">старт!</button>
  <div id="score"></div>
  <div id="court">
    <div id="firstPlayer"></div>
    <div id="secondPlayer"></div>
    <div id="ball"></div>
  </div>
  <script>
    // создаём поле для игры
    const court = document.getElementById("court");
    const width = "600px";
    const height = "400px";
    court.style.width = width;
    court.style.height = height;
    
    // создаём мяч для игры
    let ball={
        posX : 300,
        posY : 200,
        speedX : 1,
        speedY : 1,
        width : 30,
        height: 30,

        update: function() {
            const ballElem=
                document.getElementById('ball');
            ballElem.style.left=this.posX+"px";
            ballElem.style.top=this.posY+"px";
        }
    }

    const ballMove = () => {
      ball.posX+=ball.speedX;
      ball.posY+=ball.speedY;
        // вылетел ли мяч правее стены?
        if ( ball.posX+ball.width>600) {
            ball.speedX=-ball.speedX;
            ball.posX=600-ball.width;
        }
        // вылетел ли мяч левее стены?
        if ( ball.posX<0 ) {
            ball.speedX=-ball.speedX;
            ball.posX=0;
        }
        if ( ball.posY+ball.height>400) {
            ball.speedY=-ball.speedY;
            ball.posY=400-ball.width;
        }
        if ( ball.posY<0 ) {
            ball.speedY=-ball.speedY;
            ball.posY=0;
        }
        ball.update();
    }
    ball.update();

    // ball = document.getElementById("ball");
    // ball.style.width = "30px";
    // ball.style.height = "30px";
    // ball.style.left = `${600/2}px`;
    // ball.style.top = `${400/2}px`;


    // создаём ракетки 

    let firstPlayer = {
      move: false,
    }

    let secondPlayer = {
      move: false,
    }
    
    firstPlayer.el = document.getElementById("firstPlayer");
    firstPlayer.el.style.width = "12px";
    firstPlayer.el.style.height = "120px";

    secondPlayer.el = document.getElementById("secondPlayer");
    secondPlayer.el.style.width = "12px";
    secondPlayer.el.style.height = "120px";
    secondPlayer.el.style.left = "588px";

    // Запускаем движение ракеток
      firstPlayer.topCoordinate = 0;
      secondPlayer.topCoordinate = 0;
      
      document.addEventListener ('keydown', (e) => {
      switch (e.keyCode) {
        case 16: 
            firstPlayer.move = -2;
          break; 
        case 17:
            firstPlayer.move = 2;
          break;
        case 38:
          if (secondPlayer.topCoordinate > 0) 
            secondPlayer.move = -2;
            else secondPlayer.move = 0;
          break;
        case 40:
          if (secondPlayer.topCoordinate <275)
            secondPlayer.move = 2;
            else secondPlayer.move = 0;
          break;
      }})

      document.addEventListener ('keyup', (e) => {
        if ([16, 17].includes(e.keyCode))
          firstPlayer.move = 0;

        if ([38, 40].includes(e.keyCode))
          secondPlayer.move = 0;
      })

      const racketMove1 = () => { 
        if (firstPlayer.topCoordinate > 0 || firstPlayer.topCoordinate < 278)
          {
            firstPlayer.topCoordinate += firstPlayer.move
          }  else if (firstPlayer.topCoordinate <= 0) 
          {
            firstPlayer.topCoordinate = 0
          } else if (firstPlayer.topCoordinate >= 278) 
          {
            firstPlayer.topCoordinate = 278
          }
        firstPlayer.el.style.transform = `translateY(${firstPlayer.topCoordinate}px)`; 
      }

      const racketMove2 = () => {
          secondPlayer.el.style.transform = `translateY(${secondPlayer.topCoordinate+=secondPlayer.move}px)`; 
      }

      //запускаем движение мяча


    const tick = () => {
            racketMove1();
            racketMove2();
            ballMove();
            requestAnimationFrame(tick);
          }

    
    // tick();

  </script>
</body>
</html>